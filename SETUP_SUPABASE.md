# Supabase 설정 가이드 (Royal Decree for Supabase)

폐하, 이 가이드를 따라 **Supabase** 영지를 하사받으시옵소서.

## 1. 프로젝트 생성
1. [Supabase.com](https://supabase.com)에 접속하여 **Start your project**를 클릭합니다. (GitHub 계정으로 로그인)
2. **New Project**를 클릭합니다.
3. **Name**: `Dodge Poop Game` (원하는 이름)
4. **Database Password**: 강력한 비밀번호 생성 (또는 기억해두기)
5. **Region**: `Seoul` (또는 가까운 곳)
6. **Create new project** 클릭 후 잠시 기다립니다.

## 2. API 키 확보
프로젝트 대시보드에서:
1. 왼쪽 메뉴 하단 **Project Settings (톱니바퀴)** -> **API** 클릭.
2. `Project URL`과 `anon public` 키를 복사하여 어딘가에 메모해둡니다. (나중에 코드에 넣어야 함)

## 3. 데이터베이스 테이블 생성 (SQL)
왼쪽 메뉴 **SQL Editor** -> **New query** 클릭 후 아래 코드를 붙여넣고 **Run**을 누르세요.

```sql
-- 점수 테이블 생성
create table scores (
  id bigint generated by default as identity primary key,
  user_id uuid not null references auth.users on delete cascade,
  username text,
  score int not null,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- 누구나 점수 읽기 가능 (랭킹)
alter table scores enable row level security;
create policy "Anyone can view scores" on scores for select using (true);

-- 로그인한 사용자만 점수 등록 가능
create policy "Users can insert their own scores" on scores for insert with check (auth.uid() = user_id);
```

## 4. 구글 로그인 설정 (Google Auth)
1. 왼쪽 메뉴 **Authentication** -> **Providers** -> **Google** 선택.
2. **Google Cloud Console** ([console.cloud.google.com](https://console.cloud.google.com))에서 프로젝트 생성 필요.
   - **API & Services** -> **OAuth consent screen** 설정 (External, Test users에 본인 추가).
   - **Credentials** -> **Create Credentials** -> **OAuth client ID** (Web application).
   - **Authorized redirect URIs**에 Supabase 대시보드에 있는 `Callback URL (for OAuth)` 값을 복사해 붙여넣기.
3. 구글에서 발급받은 **Client ID**와 **Client Secret**을 Supabase에 입력하고 **Save**.
4. **중요**: Supabase 대시보드 왼쪽 메뉴 **Authentication** -> **URL Configuration**에서:
   - **Site URL**: `http://localhost:3000`
   - **Redirect URLs**에 `http://localhost:3000` 추가 후 **Save**. (로컬 테스트용)

## 5. 코드에 키 적용
제가 코드를 수정해두면, `game.js` 파일의 맨 윗부분에 위에서 복사한 `Project URL`과 `Anon Key`를 붙여넣으시면 됩니다.
